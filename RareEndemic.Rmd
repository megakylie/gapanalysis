---
title: "Rare and Endemic"
output: html_notebook
editor_options: 
  chunk_output_type: console
---

This is an R Markdown to analysis the distribution of rare and endemic vertebrates and invertebrates in the dataset. To understand there geographic and temporal gaps. 

Mammals, Reptiles and Amphibians are included. Birds have their own markdown.

```{r Download Packages}
# load packages
library(tidyverse)
library(lubridate)
library(ggplot2)
library(dplyr)
library(RColorBrewer)
```

#Mammals

```{r mammal data}
mam_inat <- read_csv("mammal/mam_inat.csv")

mam_chis <- read_csv("mammal/mam_chis.csv")

```

```{r mammal master}
#inat doesn't have order listed..would need to add 
mam_inat_combine <- mam_inat %>%
  rename(class="iconic_tax") %>%
  select(source, month, year, island, class, acceptedFamily, acceptedGenus, acceptedName, latitude, longitude)

mam_chis_combine <- mam_chis %>%
  rename(latitude = "decimalLatitude", longitude = "decimalLongitude") %>%
  select(source, month, year, island, class, acceptedFamily, acceptedGenus, acceptedName, latitude, longitude)

mam_master = rbind(mam_inat_combine, mam_chis_combine) %>%
  # reorder the island names to show up N -> S on list
  mutate(island = fct_relevel(island, "San Miguel", "Santa Rosa", "Santa Cruz", "Anacapa", "Santa Barbara", "Santa Catalina", "San Nicolas", "San Clemente"))

```

```{r Creating a new datasheet with just endemics}
mam_end <- read_csv("mammal/mam_end.csv")

mam_end_join = inner_join(mam_master, mam_end)

```

```{r island fox}
fox = filter(mam_end_join, acceptedGenus=="Urocyon")

fox_yearrare = ggplot(fox, aes(x=year, fill=source)) + 
  geom_bar() + 
  theme_bw() + 
  labs(x="Year", y ="Number of Data Points") +   scale_fill_brewer(palette = "Dark2") + facet_wrap(vars(acceptedName), ncol=2, scales="free") 
fox_yearrare = fox_yearrare  + scale_y_continuous(expand=expansion(mult=c(0,0.05))) + scale_x_continuous(breaks=c(1880, 1890, 1900, 1910, 1920, 1930, 1940, 1950, 1960, 1970, 1980, 1990, 2000, 2010, 2020)) + theme(axis.text = element_text(size = 8), axis.title = element_text(size=15)) 

fox_yearrare

ggsave(plot=fox_yearrare, filename="mammal/MammalGraphs/mam_er_fox.png", height=30, width=35, units="cm", dpi=300)

```

```{r deermouse}
mouse = filter(mam_end_join, acceptedGenus=="Peromyscus")
mouse_yearrare = ggplot(mouse, aes(x=year, fill=source)) + 
  geom_bar() + 
  theme_bw() + 
  labs(x="Year", y ="Number of Data Points") +   scale_fill_brewer(palette = "Dark2") + facet_wrap(vars(acceptedName), ncol=2, scales="free") 
mouse_yearrare = mouse_yearrare  + scale_y_continuous(expand=expansion(mult=c(0,0.05))) + scale_x_continuous(n.breaks=8) + theme(axis.text = element_text(size = 8), axis.title = element_text(size=15)) 

mouse_yearrare

ggsave(plot=mouse_yearrare, filename="mammal/MammalGraphs/mam_er_deermouse.png", height=40, width=35, units="cm", dpi=300)
```

```{r skunk}
skunk = filter(mam_end_join, acceptedGenus=="Spilogale")
skunk_yearrare = ggplot(skunk, aes(x=year, fill=source)) + 
  geom_bar() + 
  theme_bw() + 
  labs(x="Year", y ="Number of Data Points") +   scale_fill_brewer(palette = "Dark2") + facet_wrap(vars(acceptedName), nrow=1, scales="free")  + scale_y_continuous(expand=expansion(mult=c(0,0.05))) + scale_x_continuous(n.breaks=8)

skunk_yearrare

ggsave(plot=skunk_yearrare, filename="mammal/MammalGraphs/mam_er_skunk.png", height=10, width=15, units="cm", dpi=300)
```

```{r Pacific bat}
bat1 = filter(mam_end_join, acceptedGenus=="Antrozous")
bat1_yearrare = ggplot(bat1, aes(x=year, fill=source)) + 
  geom_bar() + 
  theme_bw() + 
  labs(x="Year", y ="Number of Data Points") +   scale_fill_brewer(palette = "Dark2") + facet_wrap(vars(acceptedName), nrow=1, scales="free")  + scale_y_continuous(expand=expansion(mult=c(0,0.05))) + scale_x_continuous(n.breaks=8)

bat1_yearrare

ggsave(plot=bat1_yearrare, filename="mammal/MammalGraphs/mam_er_bat1.png", height=10, width=15, units="cm", dpi=300)
```

```{r other bat}
bat2 = filter(mam_end_join, acceptedGenus=="Corynorhinus")
bats = rbind(bat1, bat2) %>%
mutate(acceptedName2 = fct_relevel(acceptedName, "Corynorhinus townsendii pallescens", "Corynorhinus townsendii townsendii", "Antrozous pallidus pacificus"))
bat2_yearrare = ggplot(bat2, aes(x=year, fill=source)) + 
  geom_bar() + 
  theme_bw() + 
  labs(x="Year", y ="Number of Occurences") +   scale_fill_brewer(palette = "Dark2") + facet_wrap(vars(acceptedName), nrow=1, scales="free_y")  + scale_y_continuous(expand=expansion(mult=c(0,0.05))) + scale_x_continuous(breaks=c(1900, 1920, 1940, 1960, 1980, 2000, 2020))

bat2_yearrare

ggsave(plot=bat2_yearrare, filename="mammal/MammalGraphs/mam_er_bat2.png", height=10, width=30, units="cm", dpi=300)

# combining bats
bats_yearrare = ggplot(bats, aes(x=year, fill=source)) + 
  geom_bar() + 
  theme_bw() + 
  labs(x="Year", y ="Number of Data Points") +   scale_fill_brewer(palette = "Dark2") + facet_wrap(vars(acceptedName2), nrow=2, scales="free_y")  + scale_y_continuous(expand=expansion(mult=c(0,0.05))) + scale_x_continuous(breaks=c(1900, 1920, 1940, 1960, 1980, 2000, 2020))

bats_yearrare

ggsave(plot=bats_yearrare, filename="mammal/MammalGraphs/mam_er_bats.png", height=20, width=30, units="cm", dpi=300)
```

```{r harvest mouse}
harv_mouse =  filter(mam_end_join, acceptedGenus=="Reithrodontomys")
harvmouse_yearrare = ggplot(harv_mouse, aes(x=year, fill=source)) + 
  geom_bar() + 
  theme_bw() + 
  labs(x="Year", y ="Number of Occurences") +   scale_fill_brewer(palette = "Dark2") + facet_wrap(vars(acceptedName), nrow=1, scales="free")  + scale_y_continuous(expand=expansion(mult=c(0,0.05))) + scale_x_continuous(n.breaks=8)

harvmouse_yearrare

ggsave(plot=harvmouse_yearrare, filename="mammal/MammalGraphs/mam_er_harvmouse.png", height=10, width=15, units="cm", dpi=300)
```

```{r squirrel}
squirrel = filter(mam_end_join, acceptedGenus=="Otospermophilus")
squirrel_yearrare = ggplot(mam_end_island, aes(x=year, fill=source)) + 
  geom_bar() + 
  theme_bw() + 
  labs(x="Year", y ="Number of Occurences") +   scale_fill_brewer(palette = "Dark2") + facet_wrap(vars(acceptedName), nrow=2, scales="free")  + scale_y_continuous(expand=expansion(mult=c(0,0.05))) + scale_x_continuous(n.breaks=8) +
theme(axis.text = element_text(size = 8), axis.title = element_text(size=12), strip.text = element_text(size=14)) 
squirrel_yearrare

ggsave(plot=squirrel_yearrare, filename="mammal/MammalGraphs/mam_er_endemic_combo.png", height=20, width=30, units="cm", dpi=300)
```

```{r shrew}
shrew= filter(mam_end_join, acceptedGenus=="Sorex")
shrew_yearrare = ggplot(shrew, aes(x=year, fill=source)) + 
  geom_bar(width=0.75) + 
  theme_bw() + 
  labs(x="Year", y ="Number of Occurences") +   scale_fill_brewer(palette = "Dark2") + facet_wrap(vars(acceptedName), nrow=1)  + scale_y_continuous(expand=expansion(mult=c(0,0.05))) + scale_x_continuous(limits=c(1890, 2020), breaks=c(1941, 1983, 1991, 2004))

shrew_yearrare

ggsave(plot=shrew_yearrare, filename="mammal/MammalGraphs/mam_er_shrew.png", height=10, width=15, units="cm", dpi=300)

#combine squirrel and shrew 
sqshrew = rbind(squirrel, shrew)
sqshrew_yearrare = ggplot(sqshrew, aes(x=year, fill=source)) + 
  geom_bar(width=0.75) + 
  theme_bw() + 
  labs(x="Year", y ="Number of Data Points") +   scale_fill_brewer(palette = "Dark2") + facet_wrap(vars(acceptedName), nrow=1)  + scale_y_continuous(expand=expansion(mult=c(0,0.05))) + scale_x_continuous(limits=c(1920, 2020), breaks=c(1890, 1900, 1920, 1940, 1960, 1980, 2000, 2020))

sqshrew_yearrare

ggsave(plot=sqshrew_yearrare, filename="mammal/MammalGraphs/mam_er_sqshrew.png", height=10, width=30, units="cm", dpi=300)
```

```{r taxa by island}
mam_end_island = rbind(harv_mouse, shrew, squirrel, skunk)
mam_end_islandsum <- mam_end_island %>%
  mutate(no_sample = 1) %>%
  group_by(island, acceptedName, source) %>%
  summarise(samples = sum(no_sample))

mam_end_islandsum <- na.omit(subset(mam_end_islandsum, select = c(island, samples, acceptedName, source)))
island_size = read_csv("island_size.csv")
mam_end_islandsum2 = merge(mam_end_islandsum, island_size, by="island", all.y=TRUE) 

#replaced NAs in acceptedName with one of the species so an NA graph doesn't appear, but doesn't impact other graphs at all
mam_end_islandsum2$acceptedName[is.na(mam_end_islandsum2$acceptedName)] <- "Sorex ornatus willetti"


mam_end_island_ex <- ggplot(data = mam_end_islandsum2, aes(x = samples, y = fct_rev(island), fill=source)) + geom_bar(stat = "identity") + facet_wrap(vars(acceptedName), ncol=2, scales="free_x") +
  labs(y ="Island", 
       x = "Number of Data Points",
       fill = "source") +
  theme_bw() +  scale_fill_brewer(palette="Dark2") + scale_x_continuous(expand=expansion(mult=c(0,0.05))) + theme(axis.text = element_text(size = 8), axis.title = element_text(size=12), strip.text = element_text(size=14)) 
mam_end_island_ex

#4 observations in the Cal-IBIS dataset 
ggsave(plot=mam_end_island_ex, filename="mammal/MammalGraphs/mam_end_island_ex.png",  height=20, width=30, units="cm", dpi=300)
```

```{r bats island}
mam_end_island_bat 
mam_end_islandsum_bats <- bats %>%
  mutate(no_sample = 1) %>%
  group_by(island, acceptedName2, source) %>%
  summarise(samples = sum(no_sample))

mam_end_islandsum_bats <- na.omit(subset(mam_end_islandsum_bats, select = c(island, samples, acceptedName2, source)))
island_size = read_csv("island_size.csv")
mam_end_islandsum2_bats = merge(mam_end_islandsum_bats, island_size, by="island", all.y=TRUE) 

#replaced NAs in acceptedName with one of the species so an NA graph doesn't appear, but doesn't impact other graphs at all
mam_end_islandsum2_bats$acceptedName2[is.na(mam_end_islandsum2_bats$acceptedName2)] <- "Corynorhinus townsendii pallescens"


mam_end_island_bats <- ggplot(data = mam_end_islandsum2_bats, aes(x = samples, y = fct_rev(island), fill=source)) + geom_bar(stat = "identity") + facet_wrap(vars(acceptedName2), ncol=2, scales="free_x") +
  labs(y ="Island", 
       x = "Number of Data Points",
       fill = "source") +
  theme_bw() +  scale_fill_brewer(palette="Dark2") + scale_x_continuous(expand=expansion(mult=c(0,0.05))) + theme(axis.text = element_text(size = 8), axis.title = element_text(size=12), strip.text = element_text(size=14)) 
mam_end_island_bats

ggsave(plot=mam_end_island_bats, filename="mammal/MammalGraphs/mam_end_island_bats.png",  height=20, width=30, units="cm", dpi=300)
```

```{r fox island}
fox_end_islandsum <- fox %>%
  mutate(no_sample = 1) %>%
  group_by(island, acceptedName, source) %>%
  summarise(samples = sum(no_sample))

fox_end_islandsum <- na.omit(subset(fox_end_islandsum_, select = c(island, samples, acceptedName2, source)))
island_size = read_csv("island_size.csv")
fox_end_islandsum2 = merge(fox_end_islandsum, island_size, by="island", all.y=TRUE) 

#replaced NAs in acceptedName with one of the species so an NA graph doesn't appear, but doesn't impact other graphs at all
fox_end_islandsum2$acceptedName[is.na(fox_end_islandsum2$acceptedName)] <- "Urocyon littoralis littoralis"


fox_end_island <- ggplot(data = fox_end_islandsum2, aes(x = samples, y = fct_rev(island), fill=source)) + geom_bar(stat = "identity") + facet_wrap(vars(acceptedName), ncol=2, scales="free_x") +
  labs(y ="Island", 
       x = "Number of Data Points",
       fill = "source") +
  theme_bw() +  scale_fill_brewer(palette="Dark2") + scale_x_continuous(expand=expansion(mult=c(0,0.05))) + theme(axis.text = element_text(size = 8), axis.title = element_text(size=12), strip.text = element_text(size=14)) 
fox_end_island

ggsave(plot=fox_end_island, filename="mammal/MammalGraphs/fox_end_island.png",  height=30, width=35, units="cm", dpi=300)
```

```{r mouse island}

mouse_end_islandsum <- mouse %>%
  mutate(no_sample = 1) %>%
  group_by(island, acceptedName, source) %>%
  summarise(samples = sum(no_sample))

mouse_end_islandsum <- na.omit(subset(mouse_end_islandsum_, select = c(island, samples, acceptedName2, source)))
island_size = read_csv("island_size.csv")
mouse_end_islandsum2 = merge(mouse_end_islandsum, island_size, by="island", all.y=TRUE) 

mouse_end_island <- ggplot(data = mouse_end_islandsum, aes(x = samples, y = fct_rev(island), fill=source)) + geom_bar(stat = "identity") + facet_wrap(vars(acceptedName), ncol=2, scales="free_x") +
  labs(y ="Island", 
       x = "Number of Data Points",
       fill = "source") +
  theme_bw() +  scale_fill_brewer(palette="Dark2") + scale_x_continuous(expand=expansion(mult=c(0,0.05))) + theme(axis.text = element_text(size = 8), axis.title = element_text(size=12), strip.text = element_text(size=14)) 
mouse_end_island

ggsave(plot=mouse_end_island, filename="mammal/MammalGraphs/mouse_end_island.png", height=40, width=35, units="cm", dpi=300)
```


#
#Reptiles

```{r reptile data}
rep_inat <- read_csv("reptile/rep_inat.csv")

rep_chis <- read_csv("reptile/rep_chis.csv")

```

```{r reptile master}
#inat doesn't have order listed..would need to add 
rep_inat_combine <- rep_inat %>%
  rename(class="iconic_tax") %>%
  select(source, month, year, island, class, acceptedFamily, acceptedGenus, acceptedName, latitude, longitude)

rep_chis_combine <- rep_chis %>%
  rename(latitude = "decimalLatitude", longitude="decimalLongitude") %>%
  select(source_1, month, year, island_1, class, acceptedFamily, acceptedGenus, acceptedName, latitude, longitude) %>%
  rename(island = "island_1", source = "source_1")


rep_master = rbind(rep_inat_combine, rep_chis_combine) %>%
  # reorder the island names to show up N -> S on list
  mutate(island = fct_relevel(island, "San Miguel", "Santa Rosa", "Santa Cruz", "Anacapa", "Santa Barbara", "Santa Catalina", "San Nicolas", "San Clemente"))
```

```{r Creating a new datasheet with just endemics}
rep_end <- read_csv("endemic/rept_end.csv")

rep_end_join = inner_join(rep_master, rep_end)

#5 endemics to make graphs for, one group of two subsp

```

```{r night lizard}
nightliz = filter(rep_end_join, acceptedGenus=="Xantusia")
nightliz_yearrare = ggplot(nightliz, aes(x=year, fill=source)) + 
  geom_bar() + 
  theme_bw() + 
  labs(x="Year", y ="Number of Data Points") +   scale_fill_brewer(palette = "Dark2") + facet_wrap(vars(acceptedName), nrow=1, scales="free")  + scale_y_continuous(expand=expansion(mult=c(0,0.05))) + scale_x_continuous(breaks=c(1810, 1840, 1870, 1900, 1930, 1960, 1990, 2020)) + theme(axis.text = element_text(size = 8), axis.title = element_text(size=15)) 

nightliz_yearrare

ggsave(plot=nightliz_yearrare, filename="reptile/ReptileGraphs/rep_er_nightliz.png", height=10, width=30, units="cm", dpi=300)
```

```{r spiny lizard}
sceloporus = filter(rep_end_join, acceptedGenus=="Sceloporus")
sceloporus_yearrare = ggplot(sceloporus, aes(x=year, fill=source)) + 
  geom_bar() + 
  theme_bw() + 
  labs(x="Year", y ="Number of Data Points") +   scale_fill_brewer(palette = "Dark2") + facet_wrap(vars(acceptedName), nrow=1, scales="free")  + scale_y_continuous(expand=expansion(mult=c(0,0.05))) + scale_x_continuous(breaks=c(1890, 1900, 1910, 1920, 1930, 1940, 1950, 1960, 1970, 1980, 1990, 2000, 2010, 2020)) + theme(axis.text = element_text(size = 8), axis.title = element_text(size=15)) 

sceloporus_yearrare

ggsave(plot=sceloporus_yearrare, filename="reptile/ReptileGraphs/rep_er_sceloporus.png", height=10, width=15, units="cm", dpi=300)
```

```{r scr gopher snake}
scrgopher = filter(rep_end_join, acceptedGenus=="Pituophis")
scrgopher_yearrare = ggplot(scrgopher, aes(x=year, fill=source)) + 
  geom_bar() + 
  theme_bw() + 
  labs(x="Year", y ="Number of Data Points") +   scale_fill_brewer(palette = "Dark2") + facet_wrap(vars(acceptedName), nrow=1, scales="free")  + scale_y_continuous(expand=expansion(mult=c(0,0.05))) + scale_x_continuous(breaks=c(1900, 1910, 1920, 1930, 1940, 1950, 1960, 1970, 1980, 1990, 2000, 2010, 2020)) + theme(axis.text = element_text(size = 8), axis.title = element_text(size=15)) 

scrgopher_yearrare

ggsave(plot=scrgopher_yearrare, filename="reptile/ReptileGraphs/rep_er_scrgopher.png", height=10, width=15, units="cm", dpi=300)
```

```{r garter snake}
garter = filter(rep_end_join, acceptedGenus=="Thamnophis")
garter_yearrare = ggplot(garter, aes(x=year, fill=source)) + 
  geom_bar(width=0.5) + 
  theme_bw() + 
  labs(x="Year", y ="Number of Data Points") +   scale_fill_brewer(palette = "Dark2") + facet_wrap(vars(acceptedName), nrow=1, scales="free")  + scale_y_continuous(limits=c(0,5), expand=expansion(mult=c(0,0.05))) + scale_x_continuous(limits=c(1919, 1990), breaks=c(1920, 1930, 1940, 1950, 1960, 1970, 1980, 1990, 2000, 2010, 2020)) + theme(axis.text = element_text(size = 8), axis.title = element_text(size=15)) 

garter_yearrare

ggsave(plot=garter_yearrare, filename="reptile/ReptileGraphs/rep_er_garter.png", height=10, width=15, units="cm", dpi=300)
```

```{r taxa by island}
rep_end_island
rep_end_islandsum <- rep_end_join %>%
  mutate(no_sample = 1) %>%
  group_by(island, acceptedName, source) %>%
  summarise(samples = sum(no_sample))

island_size = read_csv("island_size.csv")
rep_end_islandsum2 = merge(rep_end_islandsum, island_size, by="island", all.y=TRUE) 

#replaced NAs in acceptedName with one of the species so an NA graph doesn't appear, but doesn't impact other graphs at all
rep_end_islandsum2$acceptedName[is.na(rep_end_islandsum2$acceptedName)] <- "Sceloporus occidentalis becki"


rep_end_island_ex <- ggplot(data = rep_end_islandsum2, aes(x = samples, y = fct_rev(island), fill=source)) + geom_bar(stat = "identity") + facet_wrap(vars(acceptedName), nrow=2, scales="free_x") +
  labs(y ="Island", 
       x = "Number of Data Points",
       fill = "source") +
  theme_bw() +  scale_fill_brewer(palette="Dark2") + scale_x_continuous(expand=expansion(mult=c(0,0.05))) + theme(axis.text = element_text(size = 8), axis.title = element_text(size=12), strip.text = element_text(size=14)) 
rep_end_island_ex

#4 observations in the Cal-IBIS dataset 
ggsave(plot=rep_end_island_ex, filename="reptile/ReptileGraphs/rep_end_island_ex.png",  height=20, width=40, units="cm", dpi=300)

```

#
#Amphibans 
```{r amphibian data}
amph_inat <- read_csv("amphibian/amph_inat.csv")

amph_chis <- read_csv("amphibian/amph_chis.csv")

```

```{r amphibian master}
#inat doesn't have order listed..would need to add 
amph_inat_combine <- amph_inat %>%
  rename(class="iconic_tax") %>%
  select(source, month, year, island, class, acceptedGenus, acceptedName, latitude, longitude)

amph_chis_combine <- amph_chis %>%
  rename(latitude = "decimalLatitude", longitude="decimalLongitude", month="month_", year="year_") %>%
  select(source_1, month, year, island_1, class, acceptedGenus, acceptedName, latitude, longitude) %>%
  rename(island = "island_1", source = "source_1")


amph_master = rbind(amph_inat_combine, amph_chis_combine) %>%
  # reorder the island names to show up N -> S on list
  mutate(island = fct_relevel(island, "San Miguel", "Santa Rosa", "Santa Cruz", "Anacapa", "Santa Barbara", "Santa Catalina", "San Nicolas", "San Clemente"))
```

```{r Creating a new datasheet with just endemics}
amph_end <- read_csv("endemic/amphib_end.csv")

amph_end_join = inner_join(amph_master, amph_end)

#1 endemic

```

```{r salamander}

salamander_yearrare = ggplot(amph_end_join, aes(x=year, fill=source)) + 
  geom_bar() + 
  theme_bw() + 
  labs(x="Year", y ="Number of Data Points") +   scale_fill_brewer(palette = "Dark2") + facet_wrap(vars(acceptedName), nrow=1, scales="free")  + scale_y_continuous(expand=expansion(mult=c(0,0.05))) + scale_x_continuous(breaks=c(1800, 1820, 1840, 1860, 1880, 1900, 1920, 1940, 1960, 1980, 2000, 2020)) + theme(axis.text = element_text(size = 8), axis.title = element_text(size=10), strip.text = element_text(size=11)) 

salamander_yearrare

ggsave(plot=salamander_yearrare, filename="reptile/ReptileGraphs/amph_er_salamander.png", height=10, width=15, units="cm", dpi=300)

#saved in Rep folder
```

```{r salamander by island}
amph_end_islandsum <- amph_end_join %>%
  mutate(no_sample = 1) %>%
  group_by(island, acceptedName, source) %>%
  summarise(samples = sum(no_sample))


island_size = read_csv("island_size.csv")
amph_end_islandsum2 = merge(amph_end_islandsum, island_size, by="island", all.y=TRUE) 

#replaced NAs in acceptedName with one of the species so an NA graph doesn't appear, but doesn't impact other graphs at all
amph_end_islandsum2$acceptedName[is.na(amph_end_islandsum2$acceptedName)] <- "Batrachoseps pacificus"


amph_end_island_ex <- ggplot(data = amph_end_islandsum2, aes(x = samples, y = fct_rev(island), fill=source)) + geom_bar(stat = "identity") + facet_wrap(vars(acceptedName), nrow=1, scales="free_x") +
  labs(y ="Island", 
       x = "Number of Data Points",
       fill = "source") +
  theme_bw() +  scale_fill_brewer(palette="Dark2") + scale_x_continuous(expand=expansion(mult=c(0,0.05))) + theme(axis.text = element_text(size = 8), axis.title = element_text(size=10), strip.text = element_text(size=11)) 

amph_end_island_ex

#into rep folder
ggsave(plot=amph_end_island_ex, filename="reptile/ReptileGraphs/amph_end_island_ex.png", height=10, width=15, units="cm", dpi=300)

```




